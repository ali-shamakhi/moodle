{
    "swagger": "2.0",
    "info": {
        "title": "SLMS API",
        "version": "1.0.0"
    },
    "host": "localhost/moodle",
    "basePath": "/api/v1",
    "schemes": [
        "http"
    ],
    "paths": {
        "/authenticate.php": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get login_url",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "params",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/AuthenticateParameter"
                        },
                        "type": "string",
                        "format": "application/json"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Authentication Details",
                        "schema": {
                            "$ref": "#/definitions/AuthenticateResponse"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "examples": [
                            "\r\n{\r\n\"error\":\"access_domain is unknown\"\r\n}\r\n",
                            "\r\n{\r\n\"error\":\"access_domain is not set\"\r\n}\r\n",
                            "\r\n{\r\n\"error\":\"redirect_url is not set\"\r\n}\r\n"
                        ]
                    }
                }
            }
        },
        "/course/attend.php": {
            "post": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Post attendance details",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "authorization",
                        "in": "header",
                        "description": "Access token for authorization",
                        "type": "string"
                    },
                    {
                        "name": "attend_details",
                        "in": "body",
                        "description": "The course's ID and the list of present students' IDs",
                        "schema": {
                            "$ref": "#/definitions/CourseAttendParameter"
                        },
                        "type": "string",
                        "format": "application/json"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Attendance details",
                        "schema": {
                            "$ref": "#/definitions/CourseAttendResponse"
                        }
                    },
                    "default": {
                        "description": "Unexpected Error"
                    }
                }
            }
        },
        "/course/details.php": {
            "get": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Get details of the course",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "authorization",
                        "in": "header",
                        "description": "Access token for authorization",
                        "type": "string"
                    },
                    {
                        "name": "course_id",
                        "in": "query",
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Details of the course",
                        "schema": {
                            "$ref": "#/definitions/CourseDetailsResponse"
                        }
                    },
                    "default": {
                        "description": "Unexpected Error"
                    }
                }
            }
        },
        "/courses.php": {
            "get": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Get All courses of the user",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "authorization",
                        "in": "header",
                        "description": "Access token for authorization",
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of the user's courses",
                        "schema": {
                            "$ref": "#/definitions/CoursesResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "examples": [
                            "\r\n{\r\n\"error\":\"Unauthorized\"\r\n}\r\n"
                        ]
                    },
                    "400": {
                        "description": "Bad request",
                        "examples": [
                            "\r\n{\r\n\"error\":\"no authorization header\"\r\n}\r\n"
                        ]
                    }
                }
            }
        },
        "/user/details.php": {
            "get": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Reports whether user is logged in or not.",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "authorization",
                        "in": "header",
                        "description": "Access token for authorization",
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Details about user login",
                        "schema": {
                            "$ref": "#/definitions/CheckLoginResponse"
                        }
                    },
                    "default": {
                        "description": "Unknown Error"
                    }
                }
            }
        }
    },
    "definitions": {
        "AuthenticateParameter": {
            "properties": {
                "redirect_url": {
                    "description": "",
                    "type": "string",
                    "example": "{DOMAIN}/attendance/"
                }
            }
        },
        "AuthenticateResponse": {
            "properties": {
                "login_url": {
                    "description": "",
                    "type": "string",
                    "example": "{DOMAIN}/login?redirect={DOMAIN}/attendance/"
                }
            }
        },
        "CheckLoginResponse": {
            "properties": {
                "logged_in": {
                    "description": "",
                    "type": "boolean",
                    "example": "true"
                },
                "full_name": {
                    "description": "",
                    "type": "string",
                    "example": "Ali Shamakhi"
                }
            }
        },
        "CourseAttendParameter": {
            "properties": {
                "course_id": {
                    "description": "",
                    "type": "integer",
                    "example": 2
                },
                "attend_students": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "description": "Student ID",
                        "type": "int",
                        "example": "7"
                    }
                }
            }
        },
        "CourseAttendResponse": {
            "properties": {
                "error": {
                    "description": "[Optional field] Error message (if there is error)",
                    "type": "string",
                    "example": "Unknown Error"
                }
            }
        },
        "CourseDetailsResponse": {
            "properties": {
                "error": {
                    "description": "[Optional field] Error message (if there is error)",
                    "type": "string",
                    "example": "Unknown Error"
                },
                "course_id": {
                    "description": "",
                    "type": "integer",
                    "example": 2
                },
                "pic_url": {
                    "description": "First Teacher's picture URL",
                    "type": "string"
                },
                "session_start_timestamp": {
                    "description": "",
                    "type": "integer",
                    "example": 1528095600
                },
                "session_end_timestamp": {
                    "description": "",
                    "type": "integer",
                    "example": 1528101000
                },
                "past_attendance_count": {
                    "description": "Number of past taken attendances",
                    "type": "integer",
                    "example": 10
                },
                "teachers_full_names": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "description": "Teacher's Full Name",
                        "type": "string",
                        "example": "Ali Shamakhi"
                    }
                },
                "students_details": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/StudentDetails"
                    }
                }
            }
        },
        "CourseIdParameter": {
            "properties": {
                "course_id": {
                    "description": "",
                    "type": "integer",
                    "example": 2
                }
            }
        },
        "CoursesResponse": {
            "properties": {
                "error": {
                    "description": "[Optional field] Error message (if there is error)",
                    "type": "string",
                    "example": "Unknown Error"
                },
                "pic_url": {
                    "description": "First Teacher's picture URL",
                    "type": "string"
                },
                "teachers_courses": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/TeacherCourse"
                    }
                },
                "student_courses": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/StudentCourse"
                    }
                }
            }
        },
        "StudentCourse": {
            "properties": {
                "course_id": {
                    "description": "",
                    "type": "integer",
                    "example": 1
                },
                "course_name": {
                    "description": "Course's Full Name",
                    "type": "string",
                    "example": "Computer Engineering 3962"
                },
                "absence_count": {
                    "description": "",
                    "type": "integer",
                    "example": 3
                },
                "teachers_full_names": {
                    "description": "",
                    "type": "array",
                    "items": {
                        "description": "Teacher's Full Name",
                        "type": "string",
                        "example": "Ali Shamakhi"
                    }
                }
            }
        },
        "StudentDetails": {
            "properties": {
                "id": {
                    "description": "",
                    "type": "integer",
                    "example": 7
                },
                "full_name": {
                    "description": "Student's Full Name",
                    "type": "string",
                    "example": "Masoud Moharrami"
                },
                "pic_url": {
                    "description": "URL of the Student's Profile Picture",
                    "type": "string",
                    "example": "{DOMAIN}/user/pix.php/7/f1.jpg"
                },
                "absence_count": {
                    "description": "",
                    "type": "integer",
                    "example": 3
                }
            }
        },
        "TeacherCourse": {
            "properties": {
                "course_id": {
                    "description": "",
                    "type": "integer",
                    "example": 2
                },
                "course_name": {
                    "description": "",
                    "type": "string",
                    "example": "Computer Science 3962"
                }
            }
        }
    }
}